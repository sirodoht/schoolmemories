{% extends 'main/layout.html' %}

{% load main_filters %}

{% block title %}School Memories That Matter{% endblock %}

{% block content %}
{% include 'partials/nav.html' %}
<main>
    {% if request.user.is_authenticated %}
    <div>
        [ <a href="{% url 'introduction_update' %}">Edit</a> ]
    </div>
    {% endif %}

    <div>
        {{ site_settings.introduction_as_html|safe }}
    </div>

    <div class="filter-section">
        <form method="get" action="{% url 'index' %}" class="filter-form">
            <div class="filter-group">
                <label for="country-filter">Filter by country:</label>
                <select name="country" id="country-filter" onchange="this.form.submit()">
                    <option value="">All Countries</option>
                    {% for code, name in countries %}
                    <option value="{{ code }}" {% if selected_country == code %}selected{% endif %}>{{ name }}</option>
                    {% endfor %}
                </select>
            </div>
        </form>

        <div class="filter-results">
            Showing {{ memory_list|length }} memories
            {% if selected_country %}
                from {{ selected_country|country_name }}
            {% endif %}

            {% if filters_active %}
            (<a href="{% url 'index' %}">show all</a>)
            {% endif %}
        </div>
    </div>

    <div class="memory-grid">
        {% for memory in memory_list %}
        <a href="{% url 'memory_detail' memory.id %}" class="memory-grid-item">
            <div class="memory-grid-item-text">
                <span style="color: #b1b1b1;">
                    #{{ memory.id }}&nbsp;
                </span>
                {{ memory.title }}
            </div>
            <div class="memory-grid-item-epigraph">
                <div>
                    {{ memory.get_school_type_display }}
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
</main>
{% endblock content %}
